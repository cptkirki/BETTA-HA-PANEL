<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BETAA HA Panel - BETTA Editor</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div id="provisioningRoot" class="provisioning-shell hidden">
    <div class="provisioning-card">
      <div id="provisioningWifiPage" class="provisioning-page hidden">
        <h1 id="provWifiTitle">WLAN Provisioning</h1>
        <p id="provWifiSubtitle" class="provisioning-subtitle">Verbinde das Panel mit deinem WLAN.</p>
        <label><span id="provWifiSsidLabel">SSID</span>
          <input id="provWifiSsid" type="text" placeholder="MyWiFi" maxlength="32" />
        </label>
        <label><span id="provWifiCountryCodeLabel">Laendercode</span>
          <input id="provWifiCountryCode" type="text" list="wifiCountryCodeList" placeholder="US" maxlength="2" />
        </label>
        <div class="row">
          <button id="provScanWifiBtn" class="btn small" type="button">Scan</button>
          <select id="provWifiScanResults">
            <option value="">Noch kein Scan</option>
          </select>
        </div>
        <div id="provWifiScanInfo" class="meta">Auf "Scan" klicken, um Netze zu finden.</div>
        <label><span id="provWifiPasswordLabel">Passwort</span>
          <input id="provWifiPassword" type="password" placeholder="WLAN Passwort" maxlength="64" />
        </label>
        <label class="row row-inline">
          <input id="provWifiShowPassword" type="checkbox" />
          <span id="provWifiShowPasswordLabel">Passwort anzeigen</span>
        </label>
        <div id="provWifiInfo" class="meta"></div>
        <button id="provWifiSaveBtn" class="btn primary" type="button">Speichern + Neustart</button>
      </div>

      <div id="provisioningHaPage" class="provisioning-page hidden">
        <h1 id="provHaTitle">HA Provisioning</h1>
        <p id="provHaSubtitle" class="provisioning-subtitle">Verbinde das Panel mit Home Assistant.</p>
        <label><span id="provHaUrlLabel">WebSocket URL (ws:// oder wss://)</span>
          <input id="provHaUrl" type="text" placeholder="ws://homeassistant.local:8123/api/websocket" maxlength="255" />
        </label>
        <label><span id="provHaTokenLabel">Long-lived Access Token</span>
          <input id="provHaToken" type="password" placeholder="Home Assistant Token" maxlength="511" />
        </label>
        <label class="row row-inline">
          <input id="provHaShowToken" type="checkbox" />
          <span id="provHaShowTokenLabel">Token anzeigen</span>
        </label>
        <div id="provHaInfo" class="meta"></div>
        <button id="provHaSaveBtn" class="btn primary" type="button">Speichern + Neustart</button>
      </div>
    </div>
  </div>

  <div id="editorShell" class="shell">
    <aside class="sidebar">
      <header class="sidebar-header">
        <h1 id="sidebarTitle">BETTA Editor</h1>
        <p id="sidebarSubtitle">Layout Quelle: JSON</p>
      </header>

      <div class="mode-tabs">
        <button id="layoutTabBtn" class="btn tab active">Layout</button>
        <button id="settingsTabBtn" class="btn tab">Einstellungen</button>
      </div>

      <div id="layoutPane" class="pane">
        <section id="pagesSection" class="panel-section collapsible">
          <div class="section-head">
            <h2>Seiten</h2>
            <div class="row">
              <button id="addPageBtn" class="btn small">+ Seite</button>
              <button id="deletePageBtn" class="btn small danger">Loeschen</button>
              <button id="togglePagesSection" class="btn small collapse-toggle" type="button" aria-expanded="true"
                aria-controls="pagesSectionBody">-</button>
            </div>
          </div>
          <div id="pagesSectionBody" class="section-body">
            <ul id="pagesList" class="list"></ul>
            <div class="form" style="margin-top: 8px;">
              <label>Seitentitel
                <input id="pageTitleInput" type="text" placeholder="Seitenname auf dem Display" />
              </label>
              <button id="applyPageBtn" class="btn">Seitentitel uebernehmen</button>
            </div>
          </div>
          <div id="pagesMiniList" class="section-mini"></div>
        </section>

        <section id="widgetsSection" class="panel-section collapsible">
          <div class="section-head">
            <h2>Widgets</h2>
            <button id="toggleWidgetsSection" class="btn small collapse-toggle" type="button" aria-expanded="true"
              aria-controls="widgetsSectionBody">-</button>
          </div>
          <div id="widgetsSectionBody" class="section-body">
            <div class="row">
              <button id="addSensorBtn" class="btn small">+ Sensor</button>
              <button id="addButtonBtn" class="btn small">+ Button</button>
              <button id="addSliderBtn" class="btn small">+ Slider</button>
              <button id="addGraphBtn" class="btn small">+ Graph</button>
              <button id="addEmptyTileBtn" class="btn small">+ Empty Tile</button>
              <button id="addLightTileBtn" class="btn small">+ Light Tile</button>
              <button id="addHeatingTileBtn" class="btn small">+ Heating Tile</button>
              <button id="addWeatherTileBtn" class="btn small">+ Weather</button>
              <button id="addWeather3DayBtn" class="btn small">+ Weather 3d</button>
            </div>
            <ul id="widgetsList" class="list"></ul>
            <button id="deleteWidgetBtn" class="btn danger">Widget loeschen</button>
          </div>
        </section>

        <section id="inspectorSection" class="panel-section collapsible">
          <div class="section-head">
            <h2>Inspektor</h2>
            <button id="toggleInspectorSection" class="btn small collapse-toggle" type="button" aria-expanded="true"
              aria-controls="inspectorSectionBody">-</button>
          </div>
          <div id="inspectorSectionBody" class="section-body">
            <div class="form">
              <label>Titel <input id="fTitle" type="text" /></label>
              <select id="fType" hidden>
                <option value="sensor">sensor</option>
                <option value="button">button</option>
                <option value="slider">slider</option>
                <option value="graph">graph</option>
                <option value="empty_tile">empty_tile</option>
                <option value="light_tile">light_tile</option>
                <option value="heating_tile">heating_tile</option>
                <option value="weather_tile">weather_tile</option>
                <option value="weather_3day">weather_3day</option>
              </select>
              <label id="fEntityWrap">Entitaet
                <input id="fEntity" type="text" list="entityOptions" />
                <datalist id="entityOptions"></datalist>
              </label>
              <label id="fSecondaryEntityWrap" class="hidden">Ist Entitaet (Sensor)
                <input id="fSecondaryEntity" type="text" list="sensorEntityOptions" />
                <datalist id="sensorEntityOptions"></datalist>
              </label>
              <div id="buttonOptions" class="slider-options hidden">
                <label>Button Modus
                  <select id="fButtonMode">
                    <option value="auto">auto (default switch)</option>
                    <option value="play_pause">play/pause (media_player)</option>
                    <option value="stop">stop (media_player)</option>
                    <option value="next">next (media_player)</option>
                    <option value="previous">previous (media_player)</option>
                  </select>
                </label>
                <label>Button Akzentfarbe
                  <input id="fButtonAccentColor" type="color" value="#6fe8ff" />
                </label>
              </div>
              <div id="sliderOptions" class="slider-options hidden">
                <label>Slider Entitaetstyp
                  <select id="fSliderEntityDomain">
                    <option value="auto">auto (light, media_player, cover)</option>
                    <option value="light">light</option>
                    <option value="media_player">media_player</option>
                    <option value="cover">cover</option>
                  </select>
                </label>
                <label>Slider Richtung
                  <select id="fSliderDirection">
                    <option value="auto">auto (width/height based)</option>
                    <option value="left_to_right">left_to_right (0% -> 100%)</option>
                    <option value="right_to_left">right_to_left (100% -> 0%)</option>
                    <option value="bottom_to_top">bottom_to_top (0% -> 100%)</option>
                    <option value="top_to_bottom">top_to_bottom (100% -> 0%)</option>
                  </select>
                </label>
                <label>Slider Akzentfarbe
                  <input id="fSliderAccentColor" type="color" value="#6fe8ff" />
                </label>
              </div>
              <div id="graphOptions" class="slider-options hidden">
                <label>Graph Linienfarbe
                  <input id="fGraphLineColor" type="color" value="#6fe8ff" />
                </label>
                <label>Zeitfenster (Minuten)
                  <input id="fGraphTimeWindowMin" type="number" min="1" max="1440" step="1" value="120" />
                </label>
                <label>Render Punkte (leer = auto)
                  <input id="fGraphPointCount" type="number" min="16" max="64" step="1" placeholder="auto" />
                </label>
              </div>
              <div class="grid-2">
                <label>X <input id="fX" type="number" /></label>
                <label>Y <input id="fY" type="number" /></label>
                <label>W <input id="fW" type="number" /></label>
                <label>H <input id="fH" type="number" /></label>
              </div>
              <button id="applyInspectorBtn" class="btn">Uebernehmen</button>
            </div>
          </div>
        </section>
      </div>

      <div id="settingsPane" class="pane hidden">
        <section>
          <h2 id="settingsWifiHeading">WLAN</h2>
          <div class="form">
            <label><span id="settingsWifiSsidLabel">SSID</span>
              <input id="settingsWifiSsid" type="text" placeholder="MyWiFi" maxlength="32" />
            </label>
            <label><span id="settingsWifiCountryCodeLabel">Laendercode</span>
              <input id="settingsWifiCountryCode" type="text" list="wifiCountryCodeList" placeholder="US" maxlength="2" />
            </label>
            <div class="row">
              <button id="scanWifiBtn" class="btn small" type="button">WLAN scannen</button>
              <select id="settingsWifiScanResults">
                <option value="">Noch kein Scan</option>
              </select>
            </div>
            <div id="settingsWifiScanInfo" class="meta">Auf "WLAN scannen" klicken, um Netze zu finden.</div>
            <label><span id="settingsWifiPasswordLabel">Passwort</span>
              <input id="settingsWifiPassword" type="password" placeholder="Leer lassen, um vorhandenes Passwort zu behalten" maxlength="64" />
            </label>
            <div id="settingsWifiInfo" class="meta"></div>
          </div>
        </section>

        <section>
          <h2 id="settingsHaHeading">Home Assistant</h2>
          <div class="form">
            <label><span id="settingsHaUrlLabel">WebSocket URL (ws:// oder wss://)</span>
              <input id="settingsHaUrl" type="text" placeholder="wss://homeassistant.local:8123/api/websocket" maxlength="255" />
            </label>
            <label><span id="settingsHaTokenLabel">Long-lived Access Token</span>
              <textarea id="settingsHaToken" placeholder="Leer lassen, um vorhandenen Token zu behalten" maxlength="511"></textarea>
            </label>
            <label class="row">
              <input id="settingsHaRestEnabled" type="checkbox" />
              <span id="settingsHaRestEnabledLabel">HA REST Fallback aktivieren (Standard: Aus, WS bevorzugt)</span>
            </label>
            <div id="settingsHaInfo" class="meta"></div>
          </div>
        </section>

        <section>
          <h2 id="settingsTimeHeading">Zeit</h2>
          <div class="form">
            <label><span id="settingsNtpServerLabel">NTP Server</span>
              <input id="settingsNtpServer" type="text" placeholder="pool.ntp.org" maxlength="127" />
            </label>
            <label><span id="settingsTimezoneLabel">Zeitzone (POSIX TZ)</span>
              <input id="settingsTimezone" type="text" placeholder="CET-1CEST,M3.5.0/2,M10.5.0/3" maxlength="127" />
            </label>
            <div id="settingsTimeInfo" class="meta"></div>
          </div>
        </section>

        <section>
          <h2 id="settingsUiHeading">UI</h2>
          <div class="form">
            <label><span id="settingsLanguageLabel">Sprache</span>
              <select id="settingsLanguage"></select>
            </label>
            <div id="settingsUiInfo" class="meta"></div>
            <div class="row">
              <button id="reloadLanguagesBtn" class="btn small" type="button">Sprachen neu laden</button>
              <button id="downloadLanguageBtn" class="btn small" type="button">JSON herunterladen</button>
            </div>
            <label><span id="uploadLanguageCodeLabel">Sprachcode</span>
              <input id="uploadLanguageCode" type="text" maxlength="15" placeholder="fr" />
            </label>
            <label><span id="uploadLanguageFileLabel">Uebersetzungsdatei (JSON)</span>
              <input id="uploadLanguageFile" type="file" accept="application/json,.json" />
            </label>
            <button id="uploadLanguageBtn" class="btn" type="button">Upload / Sprache hinzufuegen</button>
            <div id="settingsTranslationInfo" class="meta"></div>
          </div>
        </section>

        <section>
          <h2 id="settingsApHeading">Setup AP</h2>
          <div id="settingsApInfo" class="meta"></div>
          <div id="settingsApHint" class="meta">Wenn Setup AP aktiv ist, verbinden und <code>http://192.168.4.1</code> oeffnen.</div>
        </section>

        <section>
          <h2 id="settingsActionsHeading">Einstellungsaktionen</h2>
          <div class="row">
            <button id="reloadSettingsBtn" class="btn">Einstellungen neu laden</button>
            <button id="saveSettingsBtn" class="btn primary">Speichern + Neustart</button>
          </div>
          <div id="settingsActionsHint" class="meta">Nach dem Speichern startet das Geraet neu und wechselt ggf. vom Setup AP ins Heim-WLAN.</div>
        </section>
      </div>
    </aside>

    <main class="workspace">
      <div class="workspace-top">
        <h2 id="canvasTitle">Canvas</h2>
        <div id="status" class="status">Bereit</div>
      </div>
      <div class="workspace-body">
        <div class="canvas-wrap">
          <div id="canvas" class="canvas"></div>
        </div>
        <aside class="actions-panel">
          <section class="panel-section">
            <h2>Aktionen</h2>
            <div class="row">
              <button id="reloadBtn" class="btn">Neu laden</button>
              <button id="saveBtn" class="btn primary">Speichern</button>
              <button id="exportBtn" class="btn">Export</button>
            </div>
            <div class="row">
              <button id="importBtn" class="btn">JSON importieren</button>
              <input id="importFile" type="file" accept="application/json" />
            </div>
            <textarea id="jsonPaste" placeholder="Layout JSON hier einfuegen"></textarea>
          </section>
        </aside>
      </div>
    </main>
  </div>
  <datalist id="wifiCountryCodeList">
    <option value="US"></option>
    <option value="DE"></option>
    <option value="AT"></option>
    <option value="CH"></option>
    <option value="NL"></option>
    <option value="FR"></option>
    <option value="IT"></option>
    <option value="ES"></option>
    <option value="GB"></option>
    <option value="PL"></option>
    <option value="SE"></option>
    <option value="NO"></option>
    <option value="DK"></option>
    <option value="FI"></option>
    <option value="CZ"></option>
    <option value="PT"></option>
    <option value="IE"></option>
    <option value="BE"></option>
    <option value="JP"></option>
    <option value="CN"></option>
    <option value="KR"></option>
    <option value="AU"></option>
    <option value="CA"></option>
  </datalist>
  <script src="/app.js"></script>
</body>
</html>
